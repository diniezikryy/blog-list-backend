(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r,c=n(1),a=n.n(c),u=n(17),s=n.n(u),i=n(2),o=n.n(i),l=n(5),d=n(3),j=n(8),b=n(0),f=function(e){var t,n=e.blog,r=e.updateBlog,a=e.removeBlog,u=e.userId,s=Object(c.useState)(!1),i=Object(d.a)(s,2),o=i[0],l=i[1],f={display:o?"":"none"},p=Object(c.useState)(n),O=Object(d.a)(p,2),h=O[0],v=O[1],g=Object(c.useState)(null===(t=n.user)||void 0===t?void 0:t.id),x=Object(d.a)(g,2),m=x[0],w=(x[1],o?"hide":"show");return Object(b.jsx)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},children:Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:h.title})," by ",h.author," ",Object(b.jsx)("button",{onClick:function(){l(!o)},children:w})]}),Object(b.jsxs)("div",{style:f,children:[Object(b.jsxs)("p",{children:["Url: ",h.url]}),Object(b.jsxs)("p",{children:["Likes: ",h.likes," ",Object(b.jsx)("button",{onClick:function(){var e=Object(j.a)(Object(j.a)({},n),{},{likes:n.likes+1});r(e),v(e)},children:"like"})]}),Object(b.jsx)("div",{children:m===u?Object(b.jsx)("button",{onClick:function(){return a(n)},children:"Delete"}):""})]})]})})},p=function(e){var t=e.errorMessage,n=e.successMessage;return null===n&&null===t?null:n?Object(b.jsx)("div",{className:"success",children:n}):Object(b.jsx)("div",{className:"error",children:t})},O=function(e){var t=e.handleSubmit,n=e.setUsername,r=e.setPassword,c=e.username,a=e.password;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Login"}),Object(b.jsxs)("form",{onSubmit:t,children:[Object(b.jsxs)("div",{children:["username",Object(b.jsx)("input",{value:c,onChange:function(e){var t=e.target;return n(t.value)}})]}),Object(b.jsxs)("div",{children:["password",Object(b.jsx)("input",{type:"password",value:a,onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(b.jsx)("button",{type:"submit",children:"login"})]})]})},h=function(e){var t=e.createBlog,n=Object(c.useState)(""),r=Object(d.a)(n,2),a=r[0],u=r[1],s=Object(c.useState)(""),i=Object(d.a)(s,2),o=i[0],l=i[1],j=Object(c.useState)(""),f=Object(d.a)(j,2),p=f[0],O=f[1];return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:a,author:o,url:p}),u(""),l(""),O("")},children:[Object(b.jsxs)("div",{children:["Title:"," ",Object(b.jsx)("input",{id:"title",value:a,onChange:function(e){u(e.target.value)}})]}),Object(b.jsxs)("div",{children:["Author:"," ",Object(b.jsx)("input",{id:"author",value:o,onChange:function(e){l(e.target.value)}})]}),Object(b.jsxs)("div",{children:["Url:"," ",Object(b.jsx)("input",{id:"url",value:p,onChange:function(e){O(e.target.value)}})]}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{type:"submit",children:"add"})})]})},v=a.a.forwardRef((function(e,t){var n=e.buttonLabel,r=e.children,a=Object(c.useState)(!1),u=Object(d.a)(a,2),s=u[0],i=u[1],o={display:s?"none":""},l={display:s?"":"none"},j=function(){i(!s)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:j}})),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:o,children:Object(b.jsx)("button",{onClick:j,children:n})}),Object(b.jsxs)("div",{style:l,children:[r,Object(b.jsx)("button",{onClick:j,children:"cancel"})]})]})})),g=n(6),x=n.n(g),m="/api/blogs",w=null,k={getAll:function(){return x.a.get(m).then((function(e){return e.data}))},create:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,x.a.post(m,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){w="bearer ".concat(e),r={headers:{Authorization:w}}},update:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.put("".concat(m,"/").concat(t.id),t,r);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.delete("".concat(m,"/").concat(t),r);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(){var e=Object(c.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),u=Object(d.a)(a,2),s=u[0],i=u[1],j=Object(c.useState)(""),g=Object(d.a)(j,2),x=g[0],m=g[1],w=Object(c.useState)(null),S=Object(d.a)(w,2),B=S[0],T=S[1],C=Object(c.useState)(null),A=Object(d.a)(C,2),I=A[0],L=A[1],U=Object(c.useState)(null),D=Object(d.a)(U,2),N=D[0],J=D[1];Object(c.useEffect)((function(){k.getAll().then((function(e){return r(e)}))}),[]),Object(c.useEffect)((function(){var e=window.localStorage.getItem("loggedBloglistUser");if(e){var t=JSON.parse(e);J(t),k.setToken(t.token)}}),[]);var M=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,y.login({username:s,password:x});case 4:n=e.sent,window.localStorage.setItem("loggedBloglistUser",JSON.stringify(n)),k.setToken(n.token),J(n),i(""),m(""),L("Welcome, ".concat(n.name,"!")),T(null),setTimeout((function(){L(null)}),5e3),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),T("wrong credentials"),L(null),setTimeout((function(){T(null)}),5e3);case 20:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),window.localStorage.clear(),T("".concat(N.name," has logged out")),L(null),setTimeout((function(){T(null)}),5e3),J(null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(l.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V.current.toggleVisibility(),e.prev=1,e.next=4,k.create(t);case 4:c=e.sent,L("Blog '".concat(t.title,"' has been successfully added")),r(n.concat(c)),T(null),setTimeout((function(){L(null)}),5e3),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),T("there are missing fields"),L(null),setTimeout((function(){T(null)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.update(t);case 3:c=e.sent,L("Blog ".concat(t.title," has been successfully updated")),r(n.map((function(e){return e.id!==t.id?e:c}))),T(null),setTimeout((function(){L(null)}),5e3),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),T("Cannot update blog ".concat(t.title)),L(null),setTimeout((function(){L(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.confirm("Delete ".concat(t.title," ?"))&&(k.remove(t.id),L("Blog ".concat(t.title," was successfully deleted")),r(n.filter((function(e){return e.id!==t.id}))),T(null),setTimeout((function(){L(null)}),5e3))}catch(c){console.log(c),T("Cannot remove blog ".concat(t.title)),L(null),setTimeout((function(){L(null)}),5e3)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Object(c.useRef)();return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"'Bookmark' your blogs!"}),Object(b.jsx)(p,{errorMessage:B,successMessage:I}),null===N?Object(b.jsx)(v,{buttonLabel:"log in",children:Object(b.jsx)(O,{username:s,password:x,setUsername:i,setPassword:m,handleSubmit:M})}):Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:[N.name," logged-in"," ",Object(b.jsx)("button",{onClick:E,type:"submit",children:"logout"}),Object(b.jsx)("div",{children:Object(b.jsx)(v,{buttonLabel:"Add Blog",ref:V,children:Object(b.jsx)(h,{createBlog:z})})})]})}),n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(b.jsx)(f,{blog:e,updateBlog:P,removeBlog:R,userId:null!==N?N.id:"Not logged in"},e.id)}))]})};n(42);s.a.render(Object(b.jsx)(S,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.1fb9b4af.chunk.js.map